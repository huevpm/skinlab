const a10_0x3cdb=['__esModule','parallel','enabled','data','../../../utilities/environment','../../../utilities/metric-logger','DistributedExecutionApi','createStartRequest','projectRoot','throw','createApiAxiosInstance','mapRespToPerfEntry','then','done','note','next','runGroup:\x20','apiAxiosInstance','maxParallel','RUNNER_FAILURE_PERF_ENTRY','createMetricRecorder','axiosException','true','../../../utilities/serializer-overrides','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','target','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','../../../utilities/axios','Starting\x20a\x20distributed\x20execution','value','error:\x20','false','error','map','__awaiter','serializeOverrides','start','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','dteStart','post','VERBOSE_LOGGING','status','ciExecutionEnv:\x20','ciExecutionId:\x20','configuration','response','axiosMultipleTries','agentCount','recordMetric'];(function(_0x3a2fcc,_0x3cdb0c){const _0x5560a0=function(_0x15598e){while(--_0x15598e){_0x3a2fcc['push'](_0x3a2fcc['shift']());}};_0x5560a0(++_0x3cdb0c);}(a10_0x3cdb,0x158));const a10_0x5560=function(_0x3a2fcc,_0x3cdb0c){_0x3a2fcc=_0x3a2fcc-0x0;let _0x5560a0=a10_0x3cdb[_0x3a2fcc];return _0x5560a0;};'use strict';var __awaiter=this&&this[a10_0x5560('0x21')]||function(_0x103211,_0x5c90bb,_0x11b9f6,_0x87bec3){function _0x314d41(_0x47b159){return _0x47b159 instanceof _0x11b9f6?_0x47b159:new _0x11b9f6(function(_0x5c4dc5){_0x5c4dc5(_0x47b159);});}return new(_0x11b9f6||(_0x11b9f6=Promise))(function(_0x5601c7,_0x1eb404){function _0x594443(_0x6d4e9b){try{_0x5adc58(_0x87bec3[a10_0x5560('0xe')](_0x6d4e9b));}catch(_0x20907d){_0x1eb404(_0x20907d);}}function _0x16012a(_0x1fe393){try{_0x5adc58(_0x87bec3[a10_0x5560('0x8')](_0x1fe393));}catch(_0x5a05df){_0x1eb404(_0x5a05df);}}function _0x5adc58(_0x26c4bc){_0x26c4bc[a10_0x5560('0xc')]?_0x5601c7(_0x26c4bc[a10_0x5560('0x1c')]):_0x314d41(_0x26c4bc[a10_0x5560('0x1c')])[a10_0x5560('0xb')](_0x594443,_0x16012a);}_0x5adc58((_0x87bec3=_0x87bec3['apply'](_0x103211,_0x5c90bb||[]))[a10_0x5560('0xe')]());});};Object['defineProperty'](exports,a10_0x5560('0x30'),{'value':!![]});exports[a10_0x5560('0x6')]=exports['DistributedExecutionApi']=void 0x0;const axios_1=require(a10_0x5560('0x1a'));const environment_1=require(a10_0x5560('0x3'));const metric_logger_1=require(a10_0x5560('0x4'));const serializer_overrides_1=require(a10_0x5560('0x16'));const {output}=require('../../../utilities/nx-imports-light');class DistributedExecutionApi{constructor(_0x5eb5c0){this[a10_0x5560('0x10')]=(0x0,axios_1[a10_0x5560('0x9')])(_0x5eb5c0);}[a10_0x5560('0x23')](_0x1741e9){var _0x17af01;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3a0e3f=(0x0,metric_logger_1[a10_0x5560('0x13')])(a10_0x5560('0x25'));let _0x4132c9;if(environment_1[a10_0x5560('0x27')]){output[a10_0x5560('0xd')]({'title':a10_0x5560('0x1b'),'bodyLines':[JSON['stringify'](_0x1741e9,null,0x2)]});}try{_0x4132c9=yield(0x0,axios_1[a10_0x5560('0x2d')])(()=>this[a10_0x5560('0x10')][a10_0x5560('0x26')]('/nx-cloud/executions/start',_0x1741e9));_0x3a0e3f[a10_0x5560('0x2f')]((0x0,metric_logger_1[a10_0x5560('0xa')])(_0x4132c9));}catch(_0x2164d8){_0x3a0e3f['recordMetric'](((_0x17af01=_0x2164d8===null||_0x2164d8===void 0x0?void 0x0:_0x2164d8[a10_0x5560('0x14')])===null||_0x17af01===void 0x0?void 0x0:_0x17af01[a10_0x5560('0x2c')])?(0x0,metric_logger_1[a10_0x5560('0xa')])(_0x2164d8[a10_0x5560('0x14')][a10_0x5560('0x2c')]):metric_logger_1[a10_0x5560('0x12')]);throw _0x2164d8;}if(!_0x4132c9[a10_0x5560('0x2')][a10_0x5560('0x1')]){throw new Error(a10_0x5560('0x24'));}if(_0x4132c9[a10_0x5560('0x2')][a10_0x5560('0x1f')]){throw new Error(_0x4132c9[a10_0x5560('0x2')][a10_0x5560('0x1f')]);}return _0x4132c9[a10_0x5560('0x2')]['id'];});}[a10_0x5560('0x28')](_0x2b1054){var _0x22569e;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3341f3=(0x0,metric_logger_1[a10_0x5560('0x13')])('dteStatus');try{const _0x857272=yield(0x0,axios_1[a10_0x5560('0x2d')])(()=>this[a10_0x5560('0x10')][a10_0x5560('0x26')]('/nx-cloud/executions/status',{'id':_0x2b1054}));_0x3341f3[a10_0x5560('0x2f')]((0x0,metric_logger_1[a10_0x5560('0xa')])(_0x857272));return _0x857272[a10_0x5560('0x2')];}catch(_0x5d8262){_0x3341f3[a10_0x5560('0x2f')](((_0x22569e=_0x5d8262===null||_0x5d8262===void 0x0?void 0x0:_0x5d8262[a10_0x5560('0x14')])===null||_0x22569e===void 0x0?void 0x0:_0x22569e[a10_0x5560('0x2c')])?(0x0,metric_logger_1[a10_0x5560('0xa')])(_0x5d8262[a10_0x5560('0x14')][a10_0x5560('0x2c')]):metric_logger_1[a10_0x5560('0x12')]);output['error']({'title':_0x5d8262['message']});process['exit'](0x1);}});}['completeRunGroupWithError'](_0x1b68e3,_0x41c735,_0x1e6bd5,_0x17a92e,_0x692664){var _0x1e27a7;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x444e94=(0x0,metric_logger_1['createMetricRecorder'])('completeRunGroup');if(environment_1['VERBOSE_LOGGING']){output['note']({'title':'Completing\x20with\x20an\x20error','bodyLines':[a10_0x5560('0x2a')+_0x1e6bd5,a10_0x5560('0x29')+_0x17a92e,a10_0x5560('0xf')+_0x41c735,a10_0x5560('0x1d')+_0x692664]});}try{const _0x3af4df=yield(0x0,axios_1[a10_0x5560('0x2d')])(()=>this[a10_0x5560('0x10')][a10_0x5560('0x26')]('/nx-cloud/executions/complete-run-group',{'branch':_0x1b68e3,'runGroup':_0x41c735,'ciExecutionId':_0x1e6bd5,'ciExecutionEnv':_0x17a92e,'criticalErrorMessage':_0x692664}),0x3);_0x444e94['recordMetric']((0x0,metric_logger_1[a10_0x5560('0xa')])(_0x3af4df));}catch(_0x32b6e8){_0x444e94[a10_0x5560('0x2f')](((_0x1e27a7=_0x32b6e8===null||_0x32b6e8===void 0x0?void 0x0:_0x32b6e8['axiosException'])===null||_0x1e27a7===void 0x0?void 0x0:_0x1e27a7[a10_0x5560('0x2c')])?(0x0,metric_logger_1[a10_0x5560('0xa')])(_0x32b6e8[a10_0x5560('0x14')][a10_0x5560('0x2c')]):metric_logger_1[a10_0x5560('0x12')]);}});}}exports[a10_0x5560('0x5')]=DistributedExecutionApi;function createStartRequest(_0xe75875,_0x27d1e,_0x47c3bf,_0x53fb91,_0x5de1e1,_0x2fb426,_0x179d25){const _0x27820f=_0x5de1e1[a10_0x5560('0x20')](_0x3815ac=>{return _0x3815ac[a10_0x5560('0x20')](_0x11d1a1=>{return{'taskId':_0x11d1a1['id'],'hash':_0x11d1a1['hash'],'projectName':_0x11d1a1['target']['project'],'target':_0x11d1a1[a10_0x5560('0x18')][a10_0x5560('0x18')],'configuration':_0x11d1a1[a10_0x5560('0x18')][a10_0x5560('0x2b')]||null,'params':(0x0,serializer_overrides_1[a10_0x5560('0x22')])(_0x11d1a1),'projectRoot':_0x11d1a1[a10_0x5560('0x7')]};});});const _0x46c4ea={'command':(0x0,environment_1['parseCommand'])(),'branch':_0xe75875,'runGroup':_0x27d1e,'ciExecutionId':_0x47c3bf,'ciExecutionEnv':_0x53fb91,'tasks':_0x27820f,'maxParallel':calculateMaxParallel(_0x2fb426),'commitSha':_0x179d25};if(environment_1[a10_0x5560('0x17')]){_0x46c4ea[a10_0x5560('0x2e')]=environment_1[a10_0x5560('0x17')];}if(!environment_1[a10_0x5560('0x19')]){_0x46c4ea['stopAgentsOnFailure']=![];}return _0x46c4ea;}exports[a10_0x5560('0x6')]=createStartRequest;function calculateMaxParallel(_0x6a883e){if(_0x6a883e[a10_0x5560('0x0')]===a10_0x5560('0x1e')||_0x6a883e[a10_0x5560('0x0')]===![]){return 0x1;}else if(_0x6a883e[a10_0x5560('0x0')]===a10_0x5560('0x15')||_0x6a883e['parallel']===!![]){return Number(_0x6a883e[a10_0x5560('0x11')]||0x3);}else if(_0x6a883e[a10_0x5560('0x0')]===undefined){return _0x6a883e[a10_0x5560('0x11')]?Number(_0x6a883e['maxParallel']):0x3;}else{return Number(_0x6a883e[a10_0x5560('0x0')])||0x3;}}