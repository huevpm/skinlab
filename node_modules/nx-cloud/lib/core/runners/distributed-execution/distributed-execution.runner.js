const a11_0x1a45=['dte-main','../../api/error-reporter.api','splitTasksIntoStages','getBranch','success','nxCloudDistributedTasksRunner','throw','canDetectRunGroup','../../../utilities/nx-imports','extractGitSha','value','SIGINT','getCIExecutionEnv','../../file-storage/file-storage','../../../utilities/metric-logger','next','createStartRequest','VERBOSE_LOGGING','warn','../../../utilities/environment','encryptionKey','printRunGroupError','log','Successfully\x20completed\x20running\x20the\x20command.','skipNxCache','DteArtifactStorage','completeRunGroupWithError','apply','FileStorage','ErrorReporterApi','createTaskGraphCompat','taskGraph','./task-graph-creator','start','__esModule','../../error/print-run-group-error','Main\x20job\x20was\x20terminated\x20via\x20SIGINT','__awaiter','getRunGroup','startTask','lifeCycle','scheduleTask','then','--skip-nx-cache\x20is\x20ignored\x20when\x20using\x20distributed\x20tasks\x20execution\x20(DTE).','defineProperty','SIGTERM','Unable\x20to\x20complete\x20a\x20run.','submitRunMetrics','done','DistributedExecutionApi','Main\x20job\x20was\x20terminated\x20via\x20SIGTERM','./split-task-graph-into-stages','See\x20run\x20details\x20at\x20','processTasks','error','exit','../../file-storage/e2e-encryption','./process-tasks','commandStatus','../../../utilities/nx-imports-light','tasks','endTasks','ENCRYPTION_KEY','E2EEncryption','runUrl'];(function(_0x40d92c,_0x1a45bd){const _0x150a6c=function(_0x174dd9){while(--_0x174dd9){_0x40d92c['push'](_0x40d92c['shift']());}};_0x150a6c(++_0x1a45bd);}(a11_0x1a45,0x75));const a11_0x150a=function(_0x40d92c,_0x1a45bd){_0x40d92c=_0x40d92c-0x0;let _0x150a6c=a11_0x1a45[_0x40d92c];return _0x150a6c;};'use strict';var __awaiter=this&&this[a11_0x150a('0x32')]||function(_0x1e81a9,_0x3fa58e,_0x3c7f9d,_0x302d42){function _0x328bea(_0x1e488f){return _0x1e488f instanceof _0x3c7f9d?_0x1e488f:new _0x3c7f9d(function(_0x50313f){_0x50313f(_0x1e488f);});}return new(_0x3c7f9d||(_0x3c7f9d=Promise))(function(_0x116938,_0xe02740){function _0x485d62(_0x240829){try{_0x49e6c1(_0x302d42[a11_0x150a('0x1c')](_0x240829));}catch(_0xefb43f){_0xe02740(_0xefb43f);}}function _0x4e8dec(_0x5372f2){try{_0x49e6c1(_0x302d42[a11_0x150a('0x13')](_0x5372f2));}catch(_0x5413d0){_0xe02740(_0x5413d0);}}function _0x49e6c1(_0x38c1f4){_0x38c1f4[a11_0x150a('0x3d')]?_0x116938(_0x38c1f4['value']):_0x328bea(_0x38c1f4[a11_0x150a('0x17')])[a11_0x150a('0x37')](_0x485d62,_0x4e8dec);}_0x49e6c1((_0x302d42=_0x302d42[a11_0x150a('0x28')](_0x1e81a9,_0x3fa58e||[]))[a11_0x150a('0x1c')]());});};Object[a11_0x150a('0x39')](exports,a11_0x150a('0x2f'),{'value':!![]});exports[a11_0x150a('0x12')]=void 0x0;const dte_artifact_storage_1=require('../../../utilities/dte-artifact-storage');const environment_1=require(a11_0x150a('0x20'));const metric_logger_1=require(a11_0x150a('0x1b'));const error_reporter_api_1=require(a11_0x150a('0xe'));const print_run_group_error_1=require(a11_0x150a('0x30'));const e2e_encryption_1=require(a11_0x150a('0x4'));const file_storage_1=require(a11_0x150a('0x1a'));const distributed_execution_api_1=require('./distributed-execution.api');const process_tasks_1=require(a11_0x150a('0x5'));const split_task_graph_into_stages_1=require(a11_0x150a('0x40'));const task_graph_creator_1=require(a11_0x150a('0x2d'));const {output}=require(a11_0x150a('0x7'));const {cacheDirectory}=require(a11_0x150a('0x15'));class NoopLifeCycle{[a11_0x150a('0x36')](_0x95dd38){}[a11_0x150a('0x34')](_0x1c5653){}[a11_0x150a('0x9')](_0x433999){}}const nxCloudDistributedTasksRunner=(_0x46d5f8,_0x44de2b,_0x534b73)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){if(_0x44de2b[a11_0x150a('0x25')]){output[a11_0x150a('0x1f')]({'title':a11_0x150a('0x38'),'bodyLine':['DTE\x20needs\x20the\x20cache\x20to\x20share\x20files\x20between\x20agents.']});}if(environment_1[a11_0x150a('0x1e')]){output['note']({'title':'Starting\x20distributed\x20command\x20execution'});}_0x44de2b[a11_0x150a('0x35')]=new NoopLifeCycle();const _0x1fe37a=(0x0,environment_1[a11_0x150a('0x10')])();const _0x444df4=(0x0,environment_1[a11_0x150a('0x33')])();const _0x2f59c6=(0x0,environment_1['getCIExecutionId'])();const _0x5d7cc9=(0x0,environment_1[a11_0x150a('0x19')])();const _0x48101d=(0x0,environment_1[a11_0x150a('0x16')])();const _0x246b3d=(0x0,environment_1['extractGitRef'])();if(!(0x0,print_run_group_error_1[a11_0x150a('0x14')])(_0x444df4,_0x2f59c6)){(0x0,print_run_group_error_1[a11_0x150a('0x22')])();process['exit'](0x1);}const _0x45e1a5=new e2e_encryption_1[(a11_0x150a('0xb'))](environment_1[a11_0x150a('0xa')]||_0x44de2b[a11_0x150a('0x21')]);const _0x3f5f23=new error_reporter_api_1[(a11_0x150a('0x2a'))](_0x44de2b);const _0x869ff8=new dte_artifact_storage_1[(a11_0x150a('0x26'))](new file_storage_1[(a11_0x150a('0x29'))](_0x45e1a5,_0x3f5f23,_0x44de2b,a11_0x150a('0xd')),cacheDirectory);const _0x5c99a4=new distributed_execution_api_1[(a11_0x150a('0x3e'))](_0x44de2b);attachSignalListenersToCompleteRunGroupOnError(_0x5c99a4,_0x1fe37a,_0x444df4,_0x2f59c6,_0x5d7cc9);try{const _0x3bd4f7=getTaskGraph(_0x534b73,_0x46d5f8,_0x44de2b);const _0x25a1cb=yield runDistributedExecution(_0x5c99a4,_0x44de2b,_0x869ff8,_0x1fe37a,_0x444df4,_0x2f59c6,_0x5d7cc9,_0x3bd4f7,_0x48101d,_0x246b3d);if(_0x25a1cb[a11_0x150a('0x6')]===0x0){output[a11_0x150a('0x11')]({'title':a11_0x150a('0x24'),'bodyLines':[a11_0x150a('0x0')+_0x25a1cb[a11_0x150a('0xc')]]});}else{output[a11_0x150a('0x2')]({'title':'Command\x20execution\x20failed.','bodyLines':[a11_0x150a('0x0')+_0x25a1cb[a11_0x150a('0xc')]]});}yield(0x0,metric_logger_1[a11_0x150a('0x3c')])(_0x44de2b);process[a11_0x150a('0x3')](_0x25a1cb['commandStatus']);}catch(_0x56c0f7){output[a11_0x150a('0x2')]({'title':a11_0x150a('0x3b'),'bodyLines':[_0x56c0f7['message']]});if(_0x56c0f7['axiosException']){console[a11_0x150a('0x23')](_0x56c0f7['axiosException']);}else{console[a11_0x150a('0x23')](_0x56c0f7);}try{yield _0x5c99a4[a11_0x150a('0x27')](_0x1fe37a,_0x444df4,_0x2f59c6,_0x5d7cc9,'Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22'+_0x56c0f7['message']+'\x22');}finally{process[a11_0x150a('0x3')](0x1);}}});exports[a11_0x150a('0x12')]=nxCloudDistributedTasksRunner;function getTaskGraph(_0x16d9aa,_0x54ee9f,_0x416a04){if(_0x16d9aa[a11_0x150a('0x2c')]){return _0x16d9aa[a11_0x150a('0x2c')];}else{return(0x0,task_graph_creator_1[a11_0x150a('0x2b')])(_0x416a04,_0x16d9aa['projectGraph'],_0x54ee9f);}}function attachSignalListenersToCompleteRunGroupOnError(_0x2e897b,_0x19b42f,_0x289ee1,_0x6298fc,_0x5a9cac){process['on'](a11_0x150a('0x18'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x2e897b['completeRunGroupWithError'](_0x19b42f,_0x289ee1,_0x6298fc,_0x5a9cac,a11_0x150a('0x31'));process[a11_0x150a('0x3')](0x1);}));process['on'](a11_0x150a('0x3a'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x2e897b[a11_0x150a('0x27')](_0x19b42f,_0x289ee1,_0x6298fc,_0x5a9cac,a11_0x150a('0x3f'));process['exit'](0x1);}));}function runDistributedExecution(_0x242449,_0x516487,_0x4ea8d0,_0x376fa5,_0x5e5c45,_0x2905f7,_0xb10d66,_0xc783f,_0x47296b,_0x170203){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x474211=yield _0x242449[a11_0x150a('0x2e')]((0x0,distributed_execution_api_1[a11_0x150a('0x1d')])(_0x376fa5,_0x5e5c45,_0x2905f7,_0xb10d66,(0x0,split_task_graph_into_stages_1[a11_0x150a('0xf')])(_0xc783f),_0x516487,_0x47296b));return yield(0x0,process_tasks_1[a11_0x150a('0x1')])(_0x242449,_0x4ea8d0,_0x474211,Object['values'](_0xc783f[a11_0x150a('0x8')]));});}