<template>
  <a-modal :title="title" :visible="visible" @ok="handleOk" :confirmLoading="confirmLoading" @cancel="handleCancel">
    <component ref="mdeol" v-bind:is="content" v-model="value"></component>
  </a-modal>
</template>
<script>
export default {
  props: {
    title: {
      type: String,
      default: "操作窗口"
    },
    content: [Object, Function],
    value: [Array, Object, Number, String]
  },
  data() {
    return {
      ModalText: 'Content of the modal',
      visible: true,
      confirmLoading: false,
    };
  },
  watch: {
    value: { //监听的对象
      deep: true, //深度监听设置为 true
      handler: function(newV, oldV) {
        console.log("执行", newV)
        this.$emit('input', newV);
      }
    }
  },
  methods: {
    showModal() {
      this.visible = true;
    },
    async handleOk(e) {
      try {
        let returned = await this.$refs.mdeol.affirm(this);
        if (returned) {
          this.handleCancel();
        }
      } catch (error) {
        console.error("事件不存在", error);
      }
    },
    handleCancel(e) {
      console.log('Clicked cancel button');
      this.visible = false;
    },
  },
};
</script>